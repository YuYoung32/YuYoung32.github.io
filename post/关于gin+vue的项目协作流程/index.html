<!DOCTYPE html>
<html lang="zh">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.111.3">
  <title> 关于Gin&#43;Vue的项目协作流程 | YuYoung&#39;s Blog </title>
  <meta name="description" content="YuYoung的博客">
  <link rel="stylesheet" href="http://example.org/css/simpleness.css">
  <link rel="canonical" href="http://example.org/post/%E5%85%B3%E4%BA%8Egin&#43;vue%E7%9A%84%E9%A1%B9%E7%9B%AE%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B/">
  <link rel="alternate" type="application/rss+xml" href="" title="YuYoung&#39;s Blog">
  
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
  
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6QCN1ZG6DB"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-6QCN1ZG6DB', { 'anonymize_ip': false });
}
</script>

  
</head>
<body class="container">
  <nav class="navigation">
  <div class="nav-left">
    
    <div class="nav-item nav-title">
      <a href="http://example.org/"> YuYoung&#39;s Blog</a>
    </div>
    <div class="nav-item nav-menu">
      
      <a href="/"> Home</a>
      
      <a href="/about/"> About</a>
      
    </div>
  </div>
  <div class="nav-item nav-right fontawesome">
    
    
    <a href="https://github.com/YuYoung32" target="_blank">
      <i title="GitHub" class="fab fa-github"></i>
    </a>
    
    
    <a href="http://example.org/index.xml" target="_blank">
      <i title="RSS" class="fas fa-rss"></i>
    </a>
    
  </div>
</nav>

  
<article class="post">
  <header class="post-header">
    <h1 style="text-align: center;" >关于Gin&#43;Vue的项目协作流程</h1>
    <div class="post-metadata">
    
      <time datetime="2022-03-01T00:00:00Z">March 01, 2022</time> &nbsp; 
    
    
    
    
    
    
      <i class="fas fa-folder"></i>
      
      <a href="/categories/web">web</a>
      &nbsp;
      
    
    </div>
  </header>

  
  <div class="post-toc">
    <div class="post-toc-title">-目录-</div>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#流程图">流程图</a></li>
    <li><a href="#后端">后端</a>
      <ul>
        <li><a href="#设计理念">设计理念</a></li>
        <li><a href="#主引擎注册">主引擎注册</a></li>
        <li><a href="#使用中间件">使用中间件</a></li>
        <li><a href="#使用日志库">使用日志库</a></li>
        <li><a href="#使用session">使用Session</a></li>
        <li><a href="#使用数据验证器">使用数据验证器</a></li>
        <li><a href="#连接数据库">连接数据库</a></li>
        <li><a href="#注册页面模板目录">注册页面模板目录</a></li>
        <li><a href="#注册静态目录">注册静态目录</a></li>
      </ul>
    </li>
    <li><a href="#前端">前端</a>
      <ul>
        <li><a href="#注册主组件">注册主组件</a></li>
        <li><a href="#注册路由">注册路由</a></li>
        <li><a href="#注册组件库">注册组件库</a></li>
        <li><a href="#创建全局变量">创建全局变量</a></li>
        <li><a href="#创建主组件">创建主组件</a></li>
        <li><a href="#创建路由">创建路由</a></li>
        <li><a href="#创建各个分组件">创建各个分组件</a></li>
      </ul>
    </li>
    <li><a href="#前端与后端交互">前端与后端交互</a>
      <ul>
        <li><a href="#总体流程图">总体流程图</a></li>
        <li><a href="#后端-数据库">后端-数据库</a></li>
        <li><a href="#后端传前端">后端传前端</a></li>
        <li><a href="#前端传后端">前端传后端</a></li>
        <li><a href="#前端与页面">前端与页面</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
  

  <div class="post-text">
    <h2 id="流程图">流程图</h2>
<p><img src="/%E5%85%B3%E4%BA%8EGin+Vue%E7%9A%84%E9%A1%B9%E7%9B%AE%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B.assets/%E9%A1%B9%E7%9B%AE%E6%B5%81%E7%A8%8B-16466700516701-16495037166502.svg" alt="项目流程"></p>
<h2 id="后端">后端</h2>
<h3 id="设计理念">设计理念</h3>
<ul>
<li>配置与程序分离，单独写在配置文件里方便修改</li>
<li>log记录在文件里持久化</li>
<li>redis记录session更快速</li>
</ul>
<h3 id="主引擎注册">主引擎注册</h3>
<p>使用<code>gin.New()</code>创建引擎，或者使用<code>gin.Default()</code>创建引擎并自动使用中间件<code>gin.Logger()</code>和<code>gin.Recovery()</code>两个中间件。</p>
<h3 id="使用中间件">使用中间件</h3>
<p>中间件需要在路由前或者创建路由时使用，这里可以在所有路由前使用中间件即<strong>全局中间件</strong>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">/</span><span style="color:#a6e22e">path</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#a6e22e">HandlerFunc</span>,<span style="color:#a6e22e">Middleware</span>)
</span></span></code></pre></div><p><strong>中间件</strong></p>
<p>以<code>ctx.Next()</code>为分界线，之前的为在请求前执行，之后的为在请求后执行。</p>
<p>众多中间件形成方法链，使用<code>ctx.Abort()</code>终止方法链并直接退出当前请求。</p>
<h3 id="使用日志库">使用日志库</h3>
<p><a href="https://zhuanlan.zhihu.com/p/105759117">快速了解</a></p>
<p><code>logrus</code>是一个常见的日志记录库。使用方法，先注册，再使用。</p>
<p>注册：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">Log</span> = <span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Log</span>.<span style="color:#a6e22e">Out</span> = <span style="color:#a6e22e">file</span>							   <span style="color:#75715e">//设置输出文件（需可写权限）
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Log</span>.<span style="color:#a6e22e">SetLevel</span>(<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">DebugLevel</span>)			   <span style="color:#75715e">//设置指定等级以上才输出
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Log</span>.<span style="color:#a6e22e">SetFormatter</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">JSONFormatter</span>{})  <span style="color:#75715e">//设置输出格式
</span></span></span></code></pre></div><p>在程序任何部位使用：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">Log</span>.<span style="color:#a6e22e">Infof</span>(<span style="color:#f92672">...</span>)
</span></span></code></pre></div><h3 id="使用session">使用Session</h3>
<p><code>Session</code>是一种保存会话的机制，用来记录用户状态信息。根据保存位置的不同可以分为基于<code>Cookie</code>的和基于<code>Redis</code>的。先注册，再使用。在<code>gin</code>中以中间件的形式注册<code>Session</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">//基于cookie的session
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cstore</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">NewStore</span>([]byte(<span style="color:#e6db74">&#34;secret&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">sessions</span>.<span style="color:#a6e22e">Sessions</span>(<span style="color:#e6db74">&#34;gin_session&#34;</span>, <span style="color:#a6e22e">cstore</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">//基于redis的session
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//最大连接数，连接模式，连接Host，密码,加密的盐
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">rstore</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">redis</span>.<span style="color:#a6e22e">NewStore</span>(<span style="color:#ae81ff">10</span>, <span style="color:#e6db74">&#34;tcp&#34;</span>, <span style="color:#e6db74">&#34;host:6379&#34;</span>, <span style="color:#e6db74">&#34;password&#34;</span>, []byte(<span style="color:#e6db74">&#34;secret&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">sessions</span>.<span style="color:#a6e22e">Sessions</span>(<span style="color:#e6db74">&#34;gin_session&#34;</span>, <span style="color:#a6e22e">rstore</span>))
</span></span></code></pre></div><p>在handler或middleware里使用：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">session</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">sessions</span>.<span style="color:#a6e22e">Default</span>(<span style="color:#a6e22e">ctx</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;age&#34;</span>, <span style="color:#e6db74">&#34;100&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;name&#34;</span>)
</span></span></code></pre></div><h3 id="使用数据验证器">使用数据验证器</h3>
<p>在结构体里使用tag里的<code>binding</code>进行验证时，可以设置自己需要的验证逻辑。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">binding</span>.<span style="color:#a6e22e">Validator</span>.<span style="color:#a6e22e">Engine</span>().(<span style="color:#f92672">*</span><span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">Validate</span>); <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">RegisterValidation</span>(<span style="color:#e6db74">&#34;len_valid6&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">fl</span> <span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">FieldLevel</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(<span style="color:#a6e22e">fl</span>.<span style="color:#a6e22e">Field</span>().<span style="color:#a6e22e">String</span>()) &gt; <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>亦或者使用<code>beego</code>的验证器，tag为<code>valid</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ShouldBind</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">valid</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">validation</span>.<span style="color:#a6e22e">Validation</span>{}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">valid</span>.<span style="color:#a6e22e">Valid</span>(<span style="color:#a6e22e">ret</span>); !<span style="color:#a6e22e">b</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">valid</span>.<span style="color:#a6e22e">Errors</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Key</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Message</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="连接数据库">连接数据库</h3>
<p><a href="https://www.tizi365.com/archives/6.html">快速了解gorm</a></p>
<p>使用<code>gorm</code>库连接数据库，一个数据库可以复用，因此可以设计函数每次使用时返回一个连接，通过以下函数打开和设置最大空闲连接数和空闲数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">db</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">DSN</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DB</span>().<span style="color:#a6e22e">SetMaxIdleConns</span>(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DB</span>().<span style="color:#a6e22e">SetMaxOpenConns</span>(<span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> <span style="color:#a6e22e">db</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">DataSourceName</span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">username</span>[:<span style="color:#a6e22e">password</span>]<span style="color:#960050;background-color:#1e0010">@</span>][<span style="color:#a6e22e">protocol</span>[(<span style="color:#a6e22e">address</span>)]]<span style="color:#f92672">/</span><span style="color:#a6e22e">dbname</span>[<span style="color:#960050;background-color:#1e0010">?</span><span style="color:#a6e22e">param1</span>=<span style="color:#a6e22e">value1</span><span style="color:#f92672">&amp;...&amp;</span><span style="color:#a6e22e">paramN</span>=<span style="color:#a6e22e">valueN</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">例：</span><span style="color:#a6e22e">root</span>:<span style="color:#ae81ff">12345</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">tcp</span>(<span style="color:#a6e22e">hostname</span>:<span style="color:#ae81ff">3306</span>)<span style="color:#f92672">/</span><span style="color:#a6e22e">dbname</span><span style="color:#960050;background-color:#1e0010">?</span><span style="color:#a6e22e">charset</span>=<span style="color:#a6e22e">utf8</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">parseTime</span>=<span style="color:#a6e22e">True</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">loc</span>=<span style="color:#a6e22e">Local</span>
</span></span></code></pre></div><h3 id="注册页面模板目录">注册页面模板目录</h3>
<p>当前后端不分离或者说需要后端渲染页面HTML代码时，需要用到页面模板。使用以下注册模板所在路径：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">LoadHTMLGlob</span>(<span style="color:#e6db74">&#34;template/**/*&#34;</span>)
</span></span></code></pre></div><h3 id="注册静态目录">注册静态目录</h3>
<p>当程序内或者网络上需要访问文件时需要注册目录，这样可以直接在网络上访问：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// 网络上访问到的，真实的路径
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">Static</span>(<span style="color:#e6db74">&#34;static&#34;</span>, <span style="color:#e6db74">&#34;static&#34;</span>)
</span></span></code></pre></div><h2 id="前端">前端</h2>
<h3 id="注册主组件">注册主组件</h3>
<p>在<code>main.js</code>内，注册主组件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createApp</span>(<span style="color:#a6e22e">App</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">mount</span>(<span style="color:#e6db74">&#39;#app&#39;</span>)
</span></span></code></pre></div><h3 id="注册路由">注册路由</h3>
<p>在<code>main.js</code>内，注册路由。此路由是<code>router.js</code>里引入的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">router</span>)
</span></span></code></pre></div><h3 id="注册组件库">注册组件库</h3>
<p>此ant组件库是<code>ant-design-vue</code>引入</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">ant</span>)
</span></span></code></pre></div><h3 id="创建全局变量">创建全局变量</h3>
<p>方便后续直接使用</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">globalProperties</span>.<span style="color:#a6e22e">$router</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">router</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">axios库</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">globalProperties</span>.<span style="color:#a6e22e">$axios</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">axios</span>.<span style="color:#a6e22e">create</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">baseURL</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;http://localhost:8090&#39;</span>,
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><h3 id="创建主组件">创建主组件</h3>
<p><code>App.vue</code>是主组件，可以在<code>&lt;template&gt;</code>里放置菜单与路由进行跳转。</p>
<h3 id="创建路由">创建路由</h3>
<p>此路由供前端跳转各个组件使用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">webHistory</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createWebHistory</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">router</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createRouter</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">history</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">webHistory</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">routes</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;index&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">component</span><span style="color:#f92672">:</span> () =&gt; <span style="color:#66d9ef">import</span>(<span style="color:#e6db74">&#34;./components/Home.vue&#34;</span>)
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">router</span>
</span></span></code></pre></div><h3 id="创建各个分组件">创建各个分组件</h3>
<p>放置在<code>commponent</code>里，实现各个功能。</p>
<h2 id="前端与后端交互">前端与后端交互</h2>
<h3 id="总体流程图">总体流程图</h3>
<p><img src="/%E5%85%B3%E4%BA%8EGin+Vue%E7%9A%84%E9%A1%B9%E7%9B%AE%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B.assets/%E6%80%BB%E4%BD%93%E6%B5%81%E7%A8%8B-16495037166491.svg" alt="总体流程"></p>
<h3 id="后端-数据库">后端-数据库</h3>
<p>使用<code>gorm</code>库。</p>
<p>先通过连接池建立连接。</p>
<p>然后创建数据模型（结构体）。数据库表一般通过数据模型进行创建。可以通过tag指定模型信息，数据库列名，类型，主外键，级联操作等：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//User has one UserDesp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//User has many Order
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//User han many Language
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;column:name;type:varchar(100);not null&#34;`</span> <span style="color:#75715e">//通过标签更改数据库属性
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Age</span>  <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//以下仅作关联，不会被写进数据库里
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">UserDesp</span>  <span style="color:#a6e22e">UserDesp</span>   <span style="color:#e6db74">`gorm:&#34;foreignKey:UserID;references:ID;constraint:OnUpdate:CASCADE,OnDelete:SET NULL;&#34;`</span> <span style="color:#75715e">//默认
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Orders</span>    []<span style="color:#a6e22e">Order</span>    <span style="color:#e6db74">`gorm:&#34;foreignKey:UserID;references:ID;constraint:OnUpdate:CASCADE,OnDelete:SET NULL;&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Languages</span> []<span style="color:#a6e22e">Language</span> <span style="color:#e6db74">`gorm:&#34;many2many:user_languages;references:ID&#34;`</span> <span style="color:#75715e">//多对多自动生成中间表
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">UserDesp</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//UserDesp belongs to User
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">UserID</span>      <span style="color:#66d9ef">uint</span> <span style="color:#75715e">//通常使用 拥有者名称+它的主键名称 作为字段名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Description</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Order</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">UserID</span>    <span style="color:#66d9ef">uint</span> <span style="color:#75715e">//通常使用 拥有者名称+它的主键名称 作为字段名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">OrderDesp</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Language</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//Language has many User
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Model</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Lan</span>   <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Users</span> []<span style="color:#a6e22e">User</span> <span style="color:#e6db74">`gorm:&#34;many2many:user_languages;references:ID&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>建表与删表</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">//创建表，默认使用user的复数形式变为蛇形命名，不会改变存在的列
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">AutoMigrate</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{})
</span></span><span style="display:flex;"><span><span style="color:#75715e">//指定名称创建表
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//db.Table(&#34;user&#34;).AutoMigrate(&amp;User{})
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//使用接口更改表名前后缀
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DefaultTableNameHandler</span>=<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>, <span style="color:#a6e22e">defaultTableName</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;sys_&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">defaultTableName</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//删除表，使用automigrate时默认使用user的复数形式
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DropTable</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{})
</span></span><span style="display:flex;"><span><span style="color:#75715e">//指定名称删除表
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DropTable</span>(<span style="color:#e6db74">&#34;user&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">//存在则删表
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DropTableIfExists</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//判断表是否存在
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">b1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">HasTable</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{})
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">b2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">HasTable</span>(<span style="color:#e6db74">&#34;user&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>基本增删改查</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">//增，直接传入结构体
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Tom&#34;</span>, <span style="color:#a6e22e">Age</span>: <span style="color:#ae81ff">18</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//查询，若DeleteAt字段不为空，则视作被删除的
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">user</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">User</span>{}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">res</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>, <span style="color:#e6db74">&#34;name=?&#34;</span>, <span style="color:#e6db74">&#34;Tom&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>).<span style="color:#a6e22e">Association</span>(<span style="color:#e6db74">&#34;UserDesp&#34;</span>).<span style="color:#a6e22e">Find</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">userDesp</span>)<span style="color:#75715e">//关联查询
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//更新，根据前一个查询的结果里的主键，若主键为空则全部更新
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//更新多个字段直接传入目标结构体即可
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>).<span style="color:#a6e22e">Update</span>(<span style="color:#e6db74">&#34;age&#34;</span>, <span style="color:#ae81ff">22</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">UserDesp</span>).<span style="color:#a6e22e">Update</span>(<span style="color:#e6db74">&#34;Description&#34;</span>, <span style="color:#e6db74">&#34;hahaha&#34;</span>)<span style="color:#75715e">//关联更新
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//删除，根据传入里的主键，若主键为空则全部删除，默认只会设置删除时间
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Delete</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span></code></pre></div><p>事务处理</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">tx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Begin</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Take</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>) <span style="color:#75715e">//此处使用tx而不是db
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">res</span> = <span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Commit</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">Error</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Rollback</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>所有接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		查询名字为Roman的第一个user的所有信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若为“所有user”，则改为Find，用法完全一样
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若为“没有且创建”，则为FirstOrCreate，用法完全一样
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若为“最后一个“，则为Last，用法完全一样
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若”部分信息“使用Select
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若”查询列“使用Pluck
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		Where子句也可以进一步分割为Not Or Order Limit Offset Count Group Having Joins
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>, <span style="color:#e6db74">&#34;name=?&#34;</span>, <span style="color:#e6db74">&#34;Roman&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">User</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Roman&#34;</span>})
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;name=?&#34;</span>, <span style="color:#e6db74">&#34;Roman&#34;</span>).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#a6e22e">User</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Roman&#34;</span>}).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#a6e22e">User</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Roman&#34;</span>}).<span style="color:#a6e22e">First</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//创建
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Name</span>:      <span style="color:#e6db74">&#34;Jack&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Age</span>:       <span style="color:#ae81ff">81</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">UserDesp</span>:  <span style="color:#a6e22e">UserDesp</span>{<span style="color:#a6e22e">Description</span>: <span style="color:#e6db74">&#34;I am a j&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Orders</span>:    []<span style="color:#a6e22e">Order</span>{{<span style="color:#a6e22e">OrderDesp</span>: <span style="color:#e6db74">&#34;oj1&#34;</span>}, {<span style="color:#a6e22e">OrderDesp</span>: <span style="color:#e6db74">&#34;oj2&#34;</span>}},
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Languages</span>: []<span style="color:#a6e22e">Language</span>{{<span style="color:#a6e22e">Lan</span>: <span style="color:#e6db74">&#34;gopher&#34;</span>}, {<span style="color:#a6e22e">Lan</span>: <span style="color:#e6db74">&#34;python3&#34;</span>}, {<span style="color:#a6e22e">Lan</span>: <span style="color:#e6db74">&#34;java2&#34;</span>}},
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		更新
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		直接传入新的结构体或KV
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若UpdateOrCreate，用Save 无主键则插入，有主键则更改
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Model</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>).<span style="color:#a6e22e">Update</span>(<span style="color:#e6db74">&#34;name&#34;</span>, <span style="color:#e6db74">&#34;Bob&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		删除
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		单个删除直接传需要删除的地址
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若批量删除，加Where更改User数据
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		若要物理删除，默认是更改DeleteAt，用Unscoped
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;name=&#34;</span>, <span style="color:#e6db74">&#34;Jack&#34;</span>).<span style="color:#a6e22e">Delete</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">User</span>{})
</span></span></code></pre></div><h3 id="后端传前端">后端传前端</h3>
<p><img src="/%E5%85%B3%E4%BA%8EGin+Vue%E7%9A%84%E9%A1%B9%E7%9B%AE%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B.assets/%E5%90%8E%E7%AB%AF%E6%B5%81%E7%A8%8B-16495037166503.svg" alt="后端流程"></p>
<h4 id="获取与返回数据">获取与返回数据</h4>
<p>使用<code>gin</code>框架的核心功能GET，POST进行路由并传入handler。常用的有这些形式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/path&#34;</span>,<span style="color:#a6e22e">HandleFunc</span>,<span style="color:#a6e22e">MiddleWare</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;/path&#34;</span>,<span style="color:#a6e22e">HandleFunc</span>,<span style="color:#a6e22e">MiddleWare</span>)
</span></span></code></pre></div><p>其中<code>HandleFunc</code>和<code>Middleware</code>参数里必须包括<code>*gin.Context</code>，Context是整个请求的上下文，包含了请求的各种信息，<code>HandleFunc</code>和<code>Middleware</code>也通过这个数据结构进行信息交换。</p>
<p>在POST或GET里，<code>HandleFunc</code>可以通过<code>ctx.JSON()</code>等<strong>返回数据</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//通过模板渲染，渲染网页并返回
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#e6db74">&#34;index.html&#34;</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;首页&#34;</span>,
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//返回JSON
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">H</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;code&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;msg&#34;</span>:  <span style="color:#e6db74">&#34;success&#34;</span>,
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//返回字符串
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#e6db74">&#34;test&#34;</span>)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>在POST或GET里，<code>HandleFunc</code>可以通过<code>ctx.Param()</code>等<strong>获取数据（动态路由）</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/:id/:name&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">id</span><span style="color:#f92672">:=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Param</span>(<span style="color:#e6db74">&#34;name&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#e6db74">&#34;id:%s,name:%s&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/id=?&amp;name=?&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">id</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;id&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Query</span>(<span style="color:#e6db74">&#34;name&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#e6db74">&#34;id:%s,name:%s&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>在POST里，<code>HandleFunc</code>可以通过<code>ctx.PostForm()</code><strong>获取表单数据</strong>（前端通过form表单提交）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;/login&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">id</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">PostForm</span>(<span style="color:#e6db74">&#34;id&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">password</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">PostForm</span>(<span style="color:#e6db74">&#34;password&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">list</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">PostFormArray</span>(<span style="color:#e6db74">&#34;list&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">user</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">PostFormMap</span>(<span style="color:#e6db74">&#34;user&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">FormFile</span>(<span style="color:#e6db74">&#34;file&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#e6db74">&#34;id: %s, password: %s, list: %v, user: %v, file: %v&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">list</span>, <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">file</span>)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><h4 id="数据绑定与验证">数据绑定与验证</h4>
<p>数据绑定，减少过多的<code>PostForm()</code>，同时tag还可以有<code>uri</code>绑定动态路由，<code>binding</code>数据验证。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">POST</span>(<span style="color:#e6db74">&#34;/post/:id&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ID</span>   <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`form:&#34;id&#34; binding:&#34;required,len=6&#34;`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`form:&#34;name&#34; binding:&#34;required,len_valid6&#34;`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Age</span>  <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`form:&#34;age&#34; binding:&#34;required,gte=0,lte=150&#34;`</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBind</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ShouldBindUri</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><h4 id="路由组">路由组</h4>
<p>为了体现层次路由可以使用路由组<code>gin.Group()</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">v1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">engine</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;/v1&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>,<span style="color:#a6e22e">Handler</span>) <span style="color:#75715e">// 路由 /v1/hello
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">v2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">Group</span>(<span style="color:#e6db74">&#34;/v2&#34;</span>)    
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">v2</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>,<span style="color:#a6e22e">Handler</span>) <span style="color:#75715e">// 路由 /v1/v2/hello
</span></span></span></code></pre></div><h4 id="跨域请求cros">跨域请求CROS</h4>
<p>使用中间件，设置header：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">CrosMiddleWare</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>)  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">method</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">Method</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Header</span>(<span style="color:#e6db74">&#34;Access-Control-Allow-Origin&#34;</span>, <span style="color:#e6db74">&#34;*&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Header</span>(<span style="color:#e6db74">&#34;Access-Control-Allow-Headers&#34;</span>, <span style="color:#e6db74">&#34;Content-Type,AccessToken,X-CSRF-Token, Authorization, Token&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Header</span>(<span style="color:#e6db74">&#34;Access-Control-Allow-Methods&#34;</span>, <span style="color:#e6db74">&#34;POST, GET, OPTIONS&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Header</span>(<span style="color:#e6db74">&#34;Access-Control-Expose-Headers&#34;</span>, <span style="color:#e6db74">&#34;Content-Length, Access-Control-Allow-Origin, Access-Control-Allow-Headers, Content-Type&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Header</span>(<span style="color:#e6db74">&#34;Access-Control-Allow-Credentials&#34;</span>, <span style="color:#e6db74">&#34;true&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//放行所有OPTIONS方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">method</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;OPTIONS&#34;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">AbortWithStatus</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusNoContent</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 处理请求
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Next</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="前端传后端">前端传后端</h3>
<p><img src="/%E5%85%B3%E4%BA%8EGin+Vue%E7%9A%84%E9%A1%B9%E7%9B%AE%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B.assets/%E5%89%8D%E7%AB%AF%E6%B5%81%E7%A8%8B-16495037166504.svg" alt="前端流程"></p>
<h4 id="get获取数据"><strong>GET获取数据</strong></h4>
<p>前端本质还是单个组件渲染页面，每个vue组件有<code>template</code>、<code>script</code>和<code>style</code>三个模块，在<code>script</code>进行前后端数据交互，然后直接渲染在<code>template</code>里。</p>
<p>在<code>script</code>里，需要在<code>export</code>的数据<code>data()</code>返回值里定义数据默认值，这个数据将在<code>template</code>里使用。注意定义数据默认值是不限类型的，因为JavaScript可以动态改变变量的类型。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;ComponentBook&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//这里必须定义
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">books</span><span style="color:#f92672">:</span> [],
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//这里使用axios的get请求后端api数据，成功后返回response，经过then分支处理。注意这里需要使用箭头函数传递给整个文件，里面的this.books指的是在data()里return的books。respose里有很多字段，data字段是返回的数据类似gin.H{}。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">getBooks</span>() { 
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">$axios</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/api/books&#39;</span>).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">books</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">books</span>
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//为了保证在渲染页面时能够直接运行这个函数，使用created自动运行，详细生命周期函数见下表
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">created</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getBooks</span>();
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>生命周期函数和浏览器渲染过程挂钩</p>
<table>
<thead>
<tr>
<th style="text-align:left">生命周期函数</th>
<th style="text-align:left">是否获取dom节点</th>
<th style="text-align:left">是否获取data</th>
<th style="text-align:left">是否获取methods</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">beforeCreate</td>
<td style="text-align:left">否</td>
<td style="text-align:left">否</td>
<td style="text-align:left">否</td>
</tr>
<tr>
<td style="text-align:left">created</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
</tr>
<tr>
<td style="text-align:left">beforeMount</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
</tr>
<tr>
<td style="text-align:left">mounted</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
</tr>
</tbody>
</table>
<h4 id="路由">路由</h4>
<p>使用<code>router-link :to</code>语法进行路由，使用<code>&lt;router-view/&gt;</code>确认路由后的内容显示位置。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#f92672">router-link</span> <span style="color:#a6e22e">to</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">首页</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/router-link&gt;</span>
</span></span></code></pre></div><p>动态路由：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">//router.js
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/book/:id&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;book_detail&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">component</span><span style="color:#f92672">:</span> () =&gt; <span style="color:#66d9ef">import</span>(<span style="color:#e6db74">&#39;./components/ComponentBookDetail.vue&#39;</span>)
</span></span><span style="display:flex;"><span>},
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span><span style="color:#75715e">&lt;!--</span> <span style="color:#a6e22e">component</span>.<span style="color:#a6e22e">vue</span> <span style="color:#f92672">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--</span> <span style="color:#a6e22e">name指定路由名称</span> <span style="color:#a6e22e">是已经注册的router</span>.<span style="color:#a6e22e">js里的路由</span> <span style="color:#a6e22e">变量与该路由相同</span> <span style="color:#f92672">--&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">router-link</span> <span style="color:#f92672">:to</span><span style="color:#e6db74">=&#34;{name:&#39;book_detail&#39;,params:{id:book.id}}&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  {{ <span style="color:#a6e22e">book</span>.<span style="color:#a6e22e">name</span> }}
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/router-link&gt;</span>
</span></span></code></pre></div><h4 id="post发送数据">POST发送数据</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">data</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//必须定义，此处为结构体类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">form</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 定义onsubmit方法，在表单@click时调用
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">onSubmit</span>() {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//使用formData解决跨域请求
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">formData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FormData</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">formData</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">name</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">formData</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;password&#39;</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">password</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">formData</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;file&#39;</span>, document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#39;input[type=file]&#39;</span>).<span style="color:#a6e22e">files</span>[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">$axios</span>.<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#39;/api/testpost&#39;</span>, <span style="color:#a6e22e">formData</span>).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">res</span>);
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>注意，需要使用<code>v-model</code>绑定数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#f92672">a-input</span> <span style="color:#a6e22e">v</span><span style="color:#f92672">-model:value</span><span style="color:#e6db74">=&#34;form.name&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a-input</span> <span style="color:#a6e22e">v</span><span style="color:#f92672">-model:value</span><span style="color:#e6db74">=&#34;form.password&#34;</span>/&gt;
</span></span></code></pre></div><h3 id="前端与页面">前端与页面</h3>
<p>直接使用<code>{{ }}</code>访问<code>data()</code>里注册的数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span>&gt;{{<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">name</span>}}&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span></code></pre></div><p>或者在需要显示的标签里使用<code>v-for</code>访问数组：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span><span style="color:#75715e">&lt;!--</span> <span style="color:#a6e22e">注意必须使用</span><span style="color:#f92672">:</span><span style="color:#a6e22e">key</span> <span style="color:#a6e22e">指定值</span> <span style="color:#f92672">--&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">span</span> <span style="color:#f92672">v-for</span><span style="color:#e6db74">=&#34;(a,i) in datas&#34; </span><span style="color:#f92672">:key</span><span style="color:#e6db74">=&#34;a&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">a.name</span> }}
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">a.age</span> }}
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">i</span> }}
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">span</span>&gt;
</span></span></code></pre></div>
  </div>

  <footer class="post-footer">
    

    

    
    
  </footer>
  
  <div class="comments">
  <div class="comments">



</div>
  </div>
</article>

  <div class="foot">
  
  &copy; 2019 - 2023 &#183;
  <a href="/"> YuYoung&#39;s Blog </a> &nbsp;&nbsp;
  <a href="#"><i class="fas fa-chevron-up"></i></a>
</div>
</body>
  <script src="/js/lazyload.min.js"></script>
<script>
  var lazyImage = new LazyLoad({container: document.getElementById('article')});
</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
<script>
    (function() {
        var $toc = $('#TableOfContents');
        if ($toc.length > 0) {
            var $window = $(window);

            function onScroll(){
                var currentScroll = $window.scrollTop();
                var h = $('.post-text h1, .post-text h2, .post-text h3, .post-text h4, .post-text h5, .post-text h6');
                var id = "";
                h.each(function (i, e) {
                    e = $(e);
                    if (e.offset().top - 10 <= currentScroll) {
                        id = e.attr('id');
                    }
                });
                var active = $toc.find('a.active');
                if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

                active.each(function (i, e) {
                    $(e).removeClass('active').siblings('ul').hide();
                });
                $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                    $(e).children('a').addClass('active').siblings('ul').show();
                });
            }

            $window.on('scroll', onScroll);
            $(document).ready(function() {
                $toc.find('a').parent('li').find('ul').hide();
                onScroll();
                document.getElementsByClassName('post-toc')[0].style.display = '';
            });
        }
    })();
</script>


</html>
